/*!
 * VERSION: 1.1.0
 * DATE: 17-Sep-2015
 * UPDATES AND DOCS AT: https://prostyle.io/plus/
 * 
 * This file is part of ProStyle Plus, a set of premium extensions for ProStyle.
 * 
 * @copyright - Copyright (c) 2013-2015, Pro Graphics, Inc. All rights reserved. 
 * @license - This work is subject to the terms at https://prostyle.io/plus/
 * @author: Gary Chamberlain, gary@pro.graphics.
 * 
 **/

var __extends=this&&this.__extends||function(b,e){function p(){this.constructor=b}for(var m in e)e.hasOwnProperty(m)&&(b[m]=e[m]);p.prototype=e.prototype;b.prototype=new p},ProStyle;
(function(b){(function(e){(function(e){(function(m){var n=function(n){function k(a,t,b,k,m,e){n.call(this,a,t,b,m,k,e)}__extends(k,n);k.prototype.scrubValue=function(a){var k=[];if("number"===typeof a)return[[void 0,a]];"string"===typeof a?a.split(",").forEach(function(a){k.push([0,b.Util.convertToNumber(a.trim())])}):a instanceof Array&&a.forEach(function(a){a instanceof Array?k.push([0<a.length?b.Util.convertToNumber(a[0]):0,1<a.length?b.Util.convertToNumber(a[1]):0]):k.push([0,b.Util.convertToNumber(a)])});
return k};k.prototype.writeCssBucket=function(a,k,b,n,m){a=n.element.proCache||{};n.element.proCache=a;n=n.elementIndex;a=a.data=[0,0];m.length>n&&(m=m[n],0<m.length&&(a[0]=m[0]),1<m.length&&(a[1]=m[1]))};return k}(b.Models.Properties.Variables.VariableType);m.BarDataVariableType=n})(e.BarChart||(e.BarChart={}))})(e.Items||(e.Items={}))})(b.Extensions||(b.Extensions={}))})(ProStyle||(ProStyle={}));
(function(b){(function(e){(function(e){(function(m){var n=b.Models.Properties,e=function(k){function a(){var a=[];a.push(new m.BarDataVariableType("values",["values"],"dummy",[],"",!0));k.call(this,"data",["data"],a)}__extends(a,k);a.prototype.createPropertyFromBoolean=function(a){return k.prototype.createPropertyFromBoolean.call(this,!1)};a.prototype.createProperty=function(a){var k=new n.Property(this);k.values.setValue(a);return k};a.prototype.createPropertyFromNumber=function(a){return this.createProperty(a)};
a.prototype.createPropertyFromString=function(a){return this.createProperty(a)};a.prototype.createPropertyFromArray=function(a){return this.createProperty(a)};a.prototype.renderLabel=function(a){return this.renderVariables(a,!1,!0)};return a}(n.PropertyType);m.BarDataPropertyType=e})(e.BarChart||(e.BarChart={}))})(e.Items||(e.Items={}))})(b.Extensions||(b.Extensions={}))})(ProStyle||(ProStyle={}));
(function(b){(function(e){(function(e){(function(m){var n=b.Models.Properties,e=function(){function k(){}k.cacheProperties=function(){k._propertyTypes=[];k._barPropertyTypes=[];var a=k._propertyTypes;a.push(n.Cache.ANIMATION);a.push(n.Cache.CLASS);a.push(n.Cache.CROP_SVG);a.push(n.Cache.OPACITY);a.push(n.Cache.POSITION);a.push(n.Cache.ROTATION);a.push(n.Cache.SCALE);a.push(n.Cache.SKEW);a=k._barPropertyTypes;a.push(n.Cache.ANIMATION);a.push(n.Cache.CLASS);a.push(new n.SvgFillPropertyType("rgba(0,0,0,0.5)"));
a.push(n.Cache.OPACITY);a.push(n.Cache.SKEW);a.push(new m.BarDataPropertyType)};k.get=function(){void 0===k._propertyTypes&&k.cacheProperties();return k._propertyTypes};k.getForBars=function(){void 0===k._barPropertyTypes&&k.cacheProperties();return k._barPropertyTypes};k._propertyTypes=void 0;k._barPropertyTypes=void 0;return k}();m.BarChartPropertyTypes=e})(e.BarChart||(e.BarChart={}))})(e.Items||(e.Items={}))})(b.Extensions||(b.Extensions={}))})(ProStyle||(ProStyle={}));
(function(b){(function(b){(function(b){(function(b){b.serialize=function(b){return{}}})(b.BarChart||(b.BarChart={}))})(b.Items||(b.Items={}))})(b.Extensions||(b.Extensions={}))})(ProStyle||(ProStyle={}));
(function(b){(function(e){(function(e){(function(m){var n=b.Util,e=function(b){function a(a,m){b.call(this,a,m,n.createChildSvgElement(m.div,"svg",{"class":"prostyle"}));this.model=a;this.barDivs=[];this.rangeBase=this.domainBase=this.domain=this.minDomain=this.maxDomain=this.barWidth=this.margin=this.height=this.width=0;this.g=n.createChildSvgElement(this.element,"g");for(var e=0;e<a.bars;e++)this.barDivs.push(n.createChildSvgElement(this.g,"rect"));this.maxDomain=a.maxDomainValue;this.minDomain=
a.minDomainValue;this.domain=Math.abs(this.maxDomain-this.minDomain);this.domainBase=0>this.maxDomain?this.maxDomain:0<this.minDomain?this.minDomain:0}__extends(a,b);a.prototype.initializeItem=function(a,b){var k=this.model.itemModelSet.flow.story,n=b.getContainedSize(this.model.itemModelSet.flow.pageAspectRatio);this.width=this.model.width/100*n.width;this.height=this.model.height/100*n.height;this.margin=this.model.margin/100*this.width;this.margin*(this.model.bars+1)>this.width?this.margin=this.width/
(this.model.bars+1):this.barWidth=(this.width-this.margin*this.model.bars)/this.model.bars;this.rangeBase=Math.abs(this.model.maxDomainValue-this.domainBase)/this.domain*this.height;var m={width:this.width,height:this.height};this.initializeProperties(k,[this.element],n,a,this.model.init,!0,m);m={};this.initializeProperties(k,this.barDivs,n,a,this.model.barsInit,!1,m,this.afterBarCssProperties.bind(this))};a.prototype.generateStepActions=function(a,b,n,k,m){this.generateActionsForStep(a,[this.element],
b,n,k,m,this.model.scriptSet);this.generateActionsForStep(a,this.barDivs,b,n,k,m,this.model.barsScriptSet,this.afterBarCssProperties.bind(this))};a.prototype.afterBarCssProperties=function(a,b,k){var m=this;0>=this.domain||b.forEach(function(a,b){var k=n.convertToNumber(a.element.proCache.data[0],m.domainBase),h=n.convertToNumber(a.element.proCache.data[1],m.domainBase),w=(m.maxDomain-Math.max(k,h))/m.domain*m.height,k=(m.maxDomain-Math.min(k,h))/m.domain*m.height-w,h=m.barWidth/8;a.attr={x:m.margin/
2+b*(m.margin+m.barWidth),width:m.barWidth,y:w,height:k,rx:h,ry:h}})};return a}(b.Views.Items.ItemView);m.BarChartItemView=e})(e.BarChart||(e.BarChart={}))})(e.Items||(e.Items={}))})(b.Extensions||(b.Extensions={}))})(ProStyle||(ProStyle={}));
(function(b){(function(e){(function(e){(function(m){var n=function(b){function k(a,m,k,n,e,p,u,q,h,w,c){b.call(this,a,"barChart","BarChart",[q,w],[h,c]);this.bars=m;this.width=k;this.height=n;this.margin=e;this.minDomainValue=p;this.maxDomainValue=u;this.barsInit=w;this.barsScriptSet=c}__extends(k,b);k.prototype.serialize=function(){return m.serialize(this)};k.prototype.createView=function(a){return new m.BarChartItemView(this,a)};return k}(b.Models.Items.ItemModel);m.BarChartItemModel=n})(e.BarChart||
(e.BarChart={}))})(e.Items||(e.Items={}))})(b.Extensions||(b.Extensions={}))})(ProStyle||(ProStyle={}));
(function(b){(function(e){function p(h,a){var c=h.length,g=a.length;if(c<g)return p(a,h);for(var d=0,f=[],l=0;l<g;l++)d+=h[l]+a[l],f[l]=d&268435455,d>>>=28;for(;l<c;l++)d+=h[l],f[l]=d&268435455,d>>>=28;d&&(f[l]=d);return f}function m(h,a){var c=h.length,g=a.length,d=0,f=[];if(g>c)return[];if(g==c){if(a[g-1]>h[g-1])return[];if(1==g)return[h[0]-a[0]]}for(var l=0;l<g;l++)d+=h[l]-a[l],f[l]=d&268435455,d>>=28;for(;l<c;l++)d+=h[l],f[l]=d&268435455,d>>=28;if(d)return[];if(f[l-1])return f;for(;1<l&&0==f[l-
1];)l--;return f.slice(0,l)}function n(h,a){a=a.concat([0]);var c=h.length,g=a.length,d=[],f,l,m,b,k,n,e,q,x;for(f=c+g;0<=f;f--)d[f]=0;for(f=0;f<c;f++)if(l=h[f])for(m=0,q=l>>14,e=l&16383,b=f,l=0;l<g;l++,b++){k=a[l];n=k>>14;k&=16383;var p=k*q+e*n;x=p>>14;p&=16383;m+=d[b]+e*k+(p<<14);d[b]=m&268435455;m=(m>>28)+n*q+x}f=d.length;if(d[f-1])return d;for(;1<f&&0==d[f-1];)f--;return d.slice(0,f)}function x(h){for(var a=[];0<h--;)a[h]=0;return a}function k(h,a,c){for(var g=0;0<=a&&0<c--;)g=268435456*g+h[a--];
return g}function a(h,a){var c=h.length-1,g=a.length-1,d=c-g;if(c<g||c==g&&(h[c]<a[c]||0<c&&h[c]==a[c]&&h[c-1]<a[c-1]))return this.q=[0],this.mod=h,this;if(c==g&&4>k(h,g,2)/k(a,g,2)){for(var f=0;;){g=m(h,a);if(0==g.length)break;h=g;f++}this.q=[f];this.mod=h;return this}var l,b;b=Math.floor(Math.log(a[g])/q)+1;if(l=28-b){h=h.concat();a=a.concat();for(e=g;0<e;e--)a[e]=a[e]<<l&268435455|a[e-1]>>b;a[0]=a[0]<<l&268435455;h[c]&268435455<<b&268435455&&(h[++c]=0,d++);for(e=c;0<e;e--)h[e]=h[e]<<l&268435455|
h[e-1]>>b;h[0]=h[0]<<l&268435455}var e,r,p,f=x(d+1);for(p=x(d).concat(a);;){r=m(h,p);if(0==r.length)break;f[d]++;h=r}var d=a[g],t=k(a,g,2);for(e=c;e>g;e--){c=e-g-1;f[c]=e>=h.length?1:h[e]==d?268435455:Math.floor(k(h,e,2)/d);for(r=k(h,e,3);f[c]*t>r;)f[c]--;p=p.slice(1);r=m(h,n([f[c]],p));0==r.length&&(f[c]--,r=m(h,n([f[c]],p)));h=r}if(l){for(e=0;e<h.length-1;e++)h[e]=h[e]>>l|h[e+1]<<b&268435455;h[h.length-1]>>=l}for(;1<f.length&&0==f[f.length-1];)f=f.slice(0,f.length-1);for(;1<h.length&&0==h[h.length-
1];)h=h.slice(0,h.length-1);this.mod=h;this.q=f;return this}function t(h,b){if(1==b.length){if(1==h.length)return[h[0]%b[0]];if(16383>b[0]){var c;c=b[0];if(16383<c)c=t(h,[c]);else{for(var g=0,d,f=h.length-1;0<=f;f--)d=h[f],g=((d>>14)+(g<<14))%c,g=((d&16383)+(g<<14))%c;c=g}return[c]}}return a(h,b).mod}function z(h,b,c){var g=[1],d,f,l=h.concat(),e=[];h=2*c.length;for(e[h--]=1;0<=h;h--)e[h]=0;e=a(e,c).q;for(h=0;h<b.length;h++)for(f=1,d=0;28>d;d++,f<<=1)b[h]&f&&(g=v(n(g,l),c,e)),l=v(n(l,l),c,e);return g}
function v(a,b,c){var g=a.length-(b.length<<1);if(0<g)return v(a.slice(0,g).concat(v(a.slice(g),b,c)),b,c);var g=b.length+1,d=n(a.slice(b.length-1),c).slice(g),f=a.slice(0,g),d=n(d,b).slice(0,g);a=m(f,d);0==a.length&&(f[g]=1,a=m(f,d));for(f=0;;f++){g=m(a,b);if(0==g.length)break;a=g;if(3<=f)return v(a,b,c)}return a}function A(a,b){var c=m(a,b);0==c.length?(this.a=m(b,a),this.sign=1):(this.a=c,this.sign=0);return this}function y(a,b){if(a.sign){if(b.sign)return A(b,a);this.a=p(a,b);this.sign=1}else if(b.sign)this.a=
p(a,b),this.sign=0;else return A(a,b);return this}function u(b,e){var c=e.concat(),g,d,f=[1],l=[0],k;f.sign=0;for(l.sign=0;1<c.length||c[0];)g=c.concat(),d=a(b,c),c=d.mod,d=d.q,b=g,g=l.concat(),k=l.sign,d=n(l,d),d.sign=l.sign,d=y(f,d),l=d.a,l.sign=d.sign,f=g,f.sign=k;a:if(c=[1],b.length!=c.length)c=0;else{for(g=b.length-1;0<=g;g--)if(b[g]!=c[g]){c=0;break a}c=1}if(0==c)return[0];f.sign&&(f=m(e,f));return f}var q=Math.log(2);e.c=function(){if(!b.pl){var a=window.location.hostname.trim().toLowerCase();
if(""!==a&&"localhost"!==a&&"127.0.0.1"!==a){b.hn=a;var e=b.plusLicense;if(void 0===e)b.pl=2;else{for(var c=[[239800443,61606552,84],[201280845,11],[166507101,13]],g="",d=0,f=0,l,k=0;k<e.length;k++)l="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_-".indexOf(e.charAt(k)),0<=l&&(d&&(g+=String.fromCharCode(l<<8-d&255|f)),f=l>>d,d+=2,8==d&&(d=0));e=g;g=e.charCodeAt(0);d=e.substr(1,g);e=e.substr(g+1);f=8*d.length;l=1;for(var g=[0],q=k=0,r=1,x=d.charCodeAt(0),v=0;v<f;v++)268435455<l&&(l=
1,g[++k]=0),x&r&&(g[k]|=l),l<<=1,255<(r<<=1)&&(r=1,x=d.charCodeAt(++q));l=c[0];d=c[1];c=c[2];f=z(t(g,d),t(l,m(d,[1])),d);g=z(t(g,c),t(l,m(c,[1])),c);l=m(g,f);0==l.length?(l=m(f,g),l=t(n(l,u(d,c)),c),l=m(c,l)):l=t(n(l,u(d,c)),c);f=c=p(n(l,d),f);l=28*f.length;k=1;q=0;c=[0];r=1;for(d=g=0;d<l;d++)f[q]&k&&(c[g]|=r),255<(r<<=1)&&(r=1,c[++g]=0),268435455<(k<<=1)&&(k=1,q++);for(;0==c[g];)g--;f="";for(d=0;d<=g;d++)f+=String.fromCharCode(c[d]);g=f;k=g.length;c=[];for(d=0;256>d;d++)c[d]=d;for(q=f=0;2>q;q++)for(d=
0;256>d;d++)f=(g.charCodeAt(d%k)+c[d]+f)%256,l=c[d],c[d]=c[f],c[f]=l;k="";for(d=0;d<e.length;d++)g=d&255,f=c[g]+f&255,l=c[g],c[g]=c[f],c[f]=l,k+=String.fromCharCode(e.charCodeAt(d)^c[(c[g]+c[f])%256]);e=k;b.pld=e;b.pl=e===a?1:3}}}}})(b.Extensions||(b.Extensions={}))})(ProStyle||(ProStyle={}));
(function(b){(function(e){(function(p){(function(m){var n=b.Serialization,p=b.Util;m.deserialize=function(b,a){e.c();var t=Math.max(1,Math.min(p.convertToNumber(p.getSetup(a,"bars")),100)),z=Math.max(0,p.convertToNumber(p.getSetup(a,"width"),50)),v=Math.max(0,p.convertToNumber(p.getSetup(a,"height"),50)),A=Math.max(0,p.convertToNumber(p.getSetup(a,"margin"),1)),y=0,u=0,q=p.getSetup(a,"domain");"number"===typeof q?u=q:q instanceof Array&&(y=0<q.length?p.convertToNumber(q[0]):0,u=1<q.length?p.convertToNumber(q[1]):
0);u<y&&(q=u,u=y,y=q);var h=m.BarChartPropertyTypes.get(),w=m.BarChartPropertyTypes.getForBars(),q=n.PropertyListReader.read(b.story,a.init,h),c=n.PropertyListReader.read(b.story,a.barInit||a.barsInit,w),h=n.ScriptSetReader.readJson(b,"Chart",a,[""],h),w=n.ScriptSetReader.readJson(b,"Bars",a,["bar","bars"],w);return new m.BarChartItemModel(b,t,z,v,A,y,u,q,h,c,w)}})(p.BarChart||(p.BarChart={}))})(e.Items||(e.Items={}))})(b.Extensions||(b.Extensions={}))})(ProStyle||(ProStyle={}));
